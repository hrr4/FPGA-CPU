library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

use work.helpers.all;

entity Fetch is
  port(
    clock        : in     std_logic;
    branch_value : in     signed(11 downto 1);
    im_instr     : in     unsigned(15 downto 0);
    stall        : in     std_logic;
    im_addr      : inout  unsigned(31 downto 1);
    pc           : buffer unsigned(31 downto 1) := (others => '0')
    );
end Fetch;

architecture Fetch of Fetch is
--signal pc : unsigned(31 downto 1) := (others => '0');
begin
  im_addr <= unsigned(signed(pc) + branch_value);
  --with stall select im_addr <=
  --      unsigned(signed(pc) + branch_value) when '0',
  --      unsigned(signed(pc)) when others;


  process(clock)
  begin
    if rising_edge(clock) then
      pc <= im_addr;
    end if;
  end process;

end Fetch;
