library ieee;
use ieee.numeric_std.all;
use ieee.std_logic_1164.all;

use work.helpers.all;

entity Store is
  port(
    defer_load      : in  std_logic;
    dm_data_rd      : in  unsigned(31 downto 0);
    instr           : in  unsigned(15 downto 0);
    wadr_store      : out unsigned(3 downto 0);
    wdata_store     : out unsigned(31 downto 0);
    write_reg_store : out std_logic;
    );
end Store;

architecture Store of Store is

begin

  process (defer_load)
  begin
    if rising_edge(defer_load) then
      -- TODO: Would need another case statement for all LDRs
      wadr_store      <= Register_Format(instr(2 downto 0), reg_len);
      wdata_store     <= dm_data_rd;
      write_reg_store <= '1';
    end if;
  end process;

end Store;
